var e,n,o,t,r,u,c,l,s,i,p,f,a,d,v,S;import h from"preact";function m(e,n,o){return{negotiatorKeys:e,responderKey:n,process:o}}function R(){for(var e in f)document.addEventListener(e,w)}function C(){for(var e in f)document.removeEventListener(e,w)}function b(e){for(var n,o=[e.target],t=[e.target];t.length;)(n=t.pop()).parentElement&&(t.push(n.parentElement),o.push(n.parentElement));return o}function y(e,n,o){var t,r,u,c,l=[];for(t=0,r=n;t<r.length;t+=1)null!=(u=r[t].__v)&&"object"==typeof u.props&&null!=(c=u.props[e])&&l.push({isCapture:o,negotiator:c,props:u.props});return l}function g(e,n,o){var t,r,u,c=[];for(t=0,r=f[e].negotiatorKeys;t<r.length;t+=1)(u=r[t]).indexOf("Capture")>-1?c.push.apply(c,y(u,o,!0)):c.push.apply(c,y(u,n,!1));return c}function M(e){var n=null!=e.composedPath?e.composedPath():b(e),o=n.concat([]).reverse();return{eventPath:n,eventPathReverse:o}}function E(e,n,o){v.ResponderEventPlugin.current={responder:o[n.responderKey],eventType:e.type,responderEvent:n,props:o}}function j(e,n,o){var t=v.ResponderEventPlugin.current.props,r=t.onResponderTerminationRequest,u=t.onResponderTerminate,c=o.onResponderGrant,l=o.onResponderReject;r?r(e)?(c&&c(e),u&&u(e),E(e,n,o)):l&&l(e):(c&&c(e),u&&u(e),E(e,n,o))}function T(e){d.touchHistory.numberActiveTouches=e.touches.length}function x(e){return e.process===r.start}function K(e){return e.process===r.move}function O(e){return e.process===r.end}function P(e,n){var o,t,r,u,c=f[e.type];if(T(e),x(c)||K(c))for(o=0,t=n;o<t.length;o+=1)r=t[o],e=Object.assign({},e,{bubbles:!r.isCapture}),r.negotiator(e)&&(null==v.ResponderEventPlugin.current?E(e,c,r.props):v.ResponderEventPlugin.current.responderEvent.process!==c.process?E(e,c,r.props):j(e,c,r.props));v.ResponderEventPlugin.current.responder(e),O(c)&&0===d.touchHistory.numberActiveTouches&&((u=v.ResponderEventPlugin.current.props.onResponderRelease)&&u(e),v.ResponderEventPlugin.current.responder=null)}function w(e){var n,o;v.ResponderEventPlugin&&(o=M(n=v.ResponderEventPlugin.extractEvents(e.type,null,e,e.target).nativeEvent),P(n,g(n.type,o.eventPath,o.eventPathReverse)))}o=(e=h.options).__p,e.__p=function(e){null!=(n=e)?R():C(),o&&o(e)},t=e.__c,e.__c=function(e){var o,r,u,c,l;if(n&&v.ResponderEventPlugin)for(o=[n];o.length;)for("string"==typeof(r=o.pop()).type&&(r.__e.__v=r),u=0,c=r.__k;u<c.length;u+=1)null!=(l=c[u])&&o.push(l);t&&t(e)},function(e){e[e.start=0]="start",e[e.move=1]="move",e[e.end=2]="end"}(r||(r={})),u=["onMoveShouldSetResponderCapture","onSelectionChangeShouldSetResponderCapture","onMoveShouldSetResponder","onSelectionChangeShouldSetResponder"],c=["onScrollShouldSetResponderCapture","onScrollShouldSetResponder"],l=m(["onStartShouldSetResponderCapture","onStartShouldSetResponder"],"onResponderStart",r.start),s=m(u,"onResponderMove",r.move),i=m(c,"onResponderMove",r.move),p=m(null,"onResponderEnd",r.end),f={touchstart:l,mousedown:l,touchmove:s,mousemove:s,selectionchange:s,scroll:i,touchend:p,mouseup:p},a={current:null,extractEvents:function(e,n,o,t){return{nativeEvent:o}},eventTypes:{responderMove:{dependencies:["touchmove","mousemove"]}}},d={touchHistory:{numberActiveTouches:0}},v={},S=function(e){v=Object.assign({},v,e)};export{a as ResponderEventPlugin,d as ResponderTouchHistoryStore,S as injectEventPluginsByName};
